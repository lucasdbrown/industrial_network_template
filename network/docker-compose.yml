services:
  god_debug:
    image: alpine:latest
    networks:
        enterprise_network:
          ipv4_address: 192.168.10.69
        idmz_network:
          ipv4_address: 192.168.20.69
        industrial_network:
          ipv4_address: 192.168.30.69
        assembly_network:
          ipv4_address: 192.168.31.69
        utilities_network:
          ipv4_address: 192.168.32.69 
        packaging_network:
          ipv4_address: 192.168.33.69
        site_operations_network:
          ipv4_address: 192.168.39.69
        logging_network:
          ipv4_address: 192.168.40.69
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]
    
  # Enterprise Router (Routes Enterprise <-> IDMZ)
  enterprise_router:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: enterprise_router.conf
    container_name: enterprise_router
    hostname: enterprise_router
    cap_add:
      - NET_ADMIN
    networks:
      enterprise_network:
        ipv4_address: 192.168.10.10
      idmz_network:
        ipv4_address: 192.168.20.10
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

  # IDMZ Router (Routes IDMZ <-> Industrial)
  idmz_router:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: idmz_router.conf
    container_name: idmz_router
    cap_add:
      - NET_ADMIN
    networks:
      idmz_network:
        ipv4_address: 192.168.20.11  # Gateway for IDMZ
      industrial_network:
        ipv4_address: 192.168.30.10  # Gateway for Industrial Zone
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

  # Industrial Core Switch (Main switch in Industrial Zone)
  industrial_core_switch:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: industrial_core_switch.conf
    container_name: industrial_core_switch
    hostname: industrial_core_switch
    cap_add:
      - NET_ADMIN
    networks:
      industrial_network:
        ipv4_address: 192.168.30.253
      assembly_network:
        ipv4_address: 192.168.31.254
      utilities_network:
        ipv4_address: 192.168.32.254
      packaging_network:
        ipv4_address: 192.168.33.254
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

  # Assembly Switch (Enclave 1)
  assembly_switch:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: assembly_switch.conf
    container_name: assembly_switch
    hostname: assembly_switch
    cap_add:
      - NET_ADMIN
    networks:
      assembly_network:
        ipv4_address: 192.168.31.253
      industrial_network:
        ipv4_address: 192.168.30.251
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

  # Utilities Switch (Enclave 2)
  utilities_switch:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: utilities_switch.conf
    container_name: utilities_switch
    hostname: utilities_switch
    cap_add:
      - NET_ADMIN
    networks:
      utilities_network:
        ipv4_address: 192.168.32.253
      industrial_network:
        ipv4_address: 192.168.30.250
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

  # Packaging Switch (Enclave 3)
  packaging_switch:
    build:
      context: ./routers
      dockerfile: DockerFile
      args:
        ROUTER_CONFIG: packaging_switch.conf
    container_name: packaging_switch
    hostname: packaging_switch
    cap_add:
      - NET_ADMIN
    networks:
      packaging_network:
        ipv4_address: 192.168.33.253
      industrial_network:
        ipv4_address: 192.168.30.249
    entrypoint: ["/bin/sh", "-c", "sleep infinity"]

networks:
  enterprise_network:
    name: enterprise_network  
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.10.0/24
          #gateway: 192.168.10.1
    driver_opts:
      com.docker.network.bridge.name: br_enterprise

  idmz_network:
    name: idmz_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.20.0/24
          #gateway: 192.168.20.1
    driver_opts:
      com.docker.network.bridge.name: br_idmz

  industrial_network:
    name: industrial_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.30.0/24
          #gateway: 192.168.30.1
    driver_opts:
      com.docker.network.bridge.name: br_industrial

  assembly_network:
    name: assembly_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.31.0/24
        # gateway: 192.168.31.254

  utilities_network:
    name: utilities_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.32.0/24
        #  gateway: 192.168.32.254

  packaging_network:
    name: packaging_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.33.0/24
        #  gateway: 192.168.33.254
  
  site_operations_network:
    name: site_operations_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.39.0/24
        #  gateway: 192.168.39.254 
  
  logging_network:
    name: logging_network
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.40.0/24
    driver_opts:
      com.docker.network.bridge.name: br_logging
